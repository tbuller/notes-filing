var app = require("../app");
var debug = rquire("debug")("filing:server");
var http = require("http");
var mongoose = require("mongoose");

var port = normalizePort(process.env.PORT || "3000");
app.set("port", port);

var mongoDbUrl = process.env.MONGODB_URL || "mongodb://0.0.0.0/filing";
mongoose.connect(mongoDbUrl, {
  useNewUrlParser: true,
  useUnifiedTopology: true,
});

var db = mongoose.connection;
db.on("error", console.error.bind(console, "Connection error: connection can't be established"))

var server = http.createServer(app);

server.listen(port);
server.on("error", onError);
server.on("listening", onListening);